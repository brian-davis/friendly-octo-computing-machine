<p style="color: green"><%= notice %></p>

<div id="books-index"
     data-controller="sortable"
     data-sortable-request-helper-outlet=".request-helper"
     data-sortable-endpoint-value="/works"
     data-action="keydown.enter->sortable#submitSearch"
     >

  <b class="major-heading">Books</b>

  <hr>
  <div class="cloud-list">
    <%= link_to(works_path, style: "text-decoration: none;", data: { turbo_stream: true, action: "click->sortable#decorateTagClick", filter_value: "all" }) do %>
      <span class="model-tag all-tag">
        <span class="model-tag-name">
          All
        </span>
        <span class="model-tag-count">
          <%= @works_count %>
        </span>
      </span>
    <% end %>

    <% @tags_cloud.each do |tag, count| %>
      <%= link_to(works_path, style: "text-decoration: none;", data: { turbo_stream: true, action: "click->sortable#decorateTagClick", filter_value: tag }) do %>
        <span class="model-tag">
          <span class="model-tag-name">
            <%= tag %>
          </span>
          <span class="model-tag-count">
            <%= count %>
          </span>
        </span>
      <% end %>
    <% end %>

    <%= link_to(works_path, style: "text-decoration: none;", data: { turbo_stream: true, action: "click->sortable#decorateTagClick", filter_value: "untagged" }) do %>
      <span class="model-tag all-tag">
        <span class="model-tag-name">
          Untagged
        </span>
        <span class="model-tag-count">
          <%= @untagged_count %>
        </span>
      </span>
    <% end %>
  </div>
  <hr>
  <div id="works-collection" class="scrollable">
    <%= text_field_tag(:search, nil, class: "search-box", tabindex: 0, data: { action:"keydown.esc->sortable#clearSearch", sortable_target: "search"}) %>
    <%= link_to("Search", "#", class: "search-button", data: {
    sortable_target:"searchButton", action: "click->sortable#search" }) %>
    |
    <%=
      select_tag(
        "_order",
        options_for_select(@sort_options), {
          class: "select-button small-text",
          include_blank: "Sort",
          data: {
            action: "change->sortable#selectOrder"
          }
        }
      )
    %>
    |
    <%=
      select_tag(
        "_order",
        options_for_select(@format_options), {
          class: "select-button small-text",
          include_blank: "Format",
          data: {
            action: "change->sortable#selectFormat"
          }
        }
      )
    %>
    |
    <%=
      select_tag(
        "_order",
        options_for_select(@language_options), {
          class: "select-button small-text",
          include_blank: "Language",
          data: {
            action: "change->sortable#selectLanguage"
          }
        }
      )
    %> |
    <%=
      select_tag(
        "_accession",
        options_for_select(@accession_options), {
          class: "select-button small-text",
          include_blank: "Accesssion",
          data: {
            action: "change->sortable#selectAccession"
          }
        }
      )
    %> |
    <%=
      select_tag(
        "_status",
        options_for_select(@status_options), {
          class: "select-button small-text",
          include_blank: "Status",
          data: {
            action: "change->sortable#selectStatus"
          }
        }
      )
    %>

    <hr>

    <div id="works">
      <%= render "works" %>
    </div>
  </div>
  <hr>
  <div class="nav-links">
    <%= link_to "Back to top", root_path, class:"nav-button" %>
    <%= link_to "New Book", new_work_path, class: "nav-button nav-action" %>
  </div>
</div>